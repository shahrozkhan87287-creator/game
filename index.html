<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Shahroz’s Tiny Runner</title>
<style>
  body{margin:0;background:#111;color:#eee;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:640px;margin:0 auto;padding:8px}
  .bar{display:flex;justify-content:space-between;margin:8px 0}
  #game{display:block;width:100%;height:auto;border:1px solid #333;background:#87ceeb;border-radius:8px}
  .note{opacity:.85;text-align:center;font-size:12px;margin-top:6px}
</style>
</head>
<body>
<div class="wrap">
  <div class="bar"><div>Score: <span id="s">0</span></div><div>Created by <b>Shahroz Khan</b></div></div>
  <canvas id="game" width="640" height="360"></canvas>
  <div class="note">Jump with Space / ↑ / Tap • Avoid the green block</div>
</div>

<script>
(function(){
  const c = document.getElementById('game');
  const x = c.getContext ? c.getContext('2d') : null;
  if(!x){ document.body.insertAdjacentHTML('beforeend','<p style="color:#f66;text-align:center">Canvas not supported or JS blocked.</p>'); return; }

  // --- constants ---
  const W=c.width, H=c.height, GY=H-40; // ground y
  const GRAV=0.6, JUMP=-11, FALLMAX=14;

  // --- state ---
  let px=120, py=GY-24, pw=24, ph=24, pvy=0, on=true, hold=false, buf=0, coyote=0;
  let ox=W+20, oy=GY-24, ow=28, oh=24, speed=4; // one obstacle
  let score=0; const scoreEl=document.getElementById('s');
  let running=true, t=0;

  // --- input: one button jump ---
  let want=false;
  function press(){ want=true; hold=true; }
  function release(){ hold=false; }
  c.addEventListener('pointerdown', press, {passive:true});
  addEventListener('pointerup', release, {passive:true});
  addEventListener('keydown', e=>{
    if(e.repeat) return;
    if(e.code==='Space'||e.code==='ArrowUp') press();
  });
  addEventListener('keyup', e=>{
    if(e.code==='Space'||e.code==='ArrowUp') release();
  });

  // --- tiny helpers ---
  function hit(ax,ay,aw,ah,bx,by,bw,bh){
    return ax<bx+bw && ax+aw>bx && ay<by+bh && ay+ah>by;
  }

  // --- loop ---
  function step(){
    if(!running) return draw(true);

    t++;

    // buffered jump + coyote
    if(want){ buf=6; want=false; }
    if(on) coyote=5; else if(coyote>0) coyote--;

    if(buf>0){
      if(on||coyote>0){ pvy=JUMP; on=false; buf=0; }
      else buf--;
    }

    // physics
    if(hold && pvy<0) pvy+=-0.25;   // variable jump height
    pvy+=GRAV; if(pvy>FALLMAX) pvy=FALLMAX;
    py+=pvy;
    if(py+ph>=GY){ py=GY-ph; pvy=0; on=true; } else on=false;

    // obstacle moves left; respawn when past
    ox-=speed;
    if(ox+ow<0){ ox=W+Math.random()*120; score++; scoreEl.textContent=score; }

    // simple difficulty ramp
    if(t%360===0) speed=Math.min(7, speed+0.4);

    // collision
    if(hit(px,py,pw,ph, ox,oy,ow,oh)){ running=false; }

    draw(false);
    requestAnimationFrame(step);
  }

  function draw(over){
    // sky
    x.fillStyle='#87ceeb'; x.fillRect(0,0,W,H);
    // ground
    x.fillStyle='#5daa2a'; x.fillRect(0,GY,W,H-GY);

    // obstacle (pipe-like block)
    x.fillStyle='#2ecc71'; x.fillRect(ox,oy,ow,oh);
    x.fillStyle='#27ae60'; x.fillRect(ox-4,oy-6,ow+8,6);

    // player (red square + hat)
    // shadow
    x.fillStyle='rgba(0,0,0,.15)'; x.beginPath(); x.ellipse(px+pw/2, py+ph+6, 14, 5, 0, 0, Math.PI*2); x.fill();
    // body
    x.fillStyle='#ff6b6b'; x.fillRect(px,py,pw,ph);
    x.fillStyle='#e74c3c'; x.fillRect(px-2,py-6,pw+4,6);

    if(over){
      x.fillStyle='rgba(0,0,0,.55)'; x.fillRect(W/2-140,H/2-50,280,100);
      x.strokeStyle='#fff3'; x.strokeRect(W/2-140,H/2-50,280,100);
      x.fillStyle='#fff'; x.textAlign='center'; x.textBaseline='middle';
      x.font='bold 26px system-ui,sans-serif'; x.fillText('GAME OVER', W/2, H/2-8);
      x.font='14px system-ui,sans-serif'; x.fillText('Tap or press Space to jump again (reload to reset)', W/2, H/2+20);
    }
  }

  // start immediately
  requestAnimationFrame(step);
})();
</script>
</body>
</html>
